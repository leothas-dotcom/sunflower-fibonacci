<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fibonacci Pattern Generator</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div class="app">
    <!-- Controls Panel -->
    <aside class="controls-panel">
      <h1>Sunflower Fibonacci</h1>
      <p class="subtitle">Interactive pattern generator for CAD workflows</p>

      <section class="control-group">
        <h2>Canvas Size</h2>
        <div class="input-row">
          <label for="canvasWidth">Width (mm)</label>
          <input type="number" id="canvasWidth" value="100" min="50" max="1000" step="10">
        </div>
        <div class="input-row">
          <label for="canvasHeight">Height (mm)</label>
          <input type="number" id="canvasHeight" value="100" min="50" max="1000" step="10">
        </div>
        <div class="button-row">
          <button id="applyCanvasSize" class="btn">Apply Size</button>
          <button id="autoFit" class="btn btn-accent" title="Auto-calculate spacing to fill canvas">Auto-Fit</button>
        </div>
      </section>

      <section class="control-group">
        <h2>Pattern Controls</h2>
        <div class="input-row">
          <label for="patternType">Pattern</label>
          <select id="patternType">
            <option value="sunflower" selected>&#x1F33B; Sunflower</option>
            <option value="pinecone">&#x1F33E; Pinecone</option>
            <option value="double-spiral">&#x1F300; Double Spiral</option>
            <option value="shape-circle">&#x2B55; Circle</option>
            <option value="shape-rectangle">&#x1F532; Rectangle</option>
            <option value="shape-triangle">&#x1F53A; Triangle</option>
          </select>
        </div>

        <div class="slider-row">
          <label for="numDots">Number of Dots</label>
          <div class="slider-with-value">
            <input type="range" id="numDots" min="1" max="5000" value="50" step="1">
            <input type="number" id="numDotsValue" class="value-input" value="50" min="1" max="5000" step="1">
          </div>
        </div>

        <div class="slider-row" id="edgeMarginRow">
          <label for="edgeMargin">Edge Margin (mm)</label>
          <div class="slider-with-value">
            <input type="range" id="edgeMargin" min="0" max="20" value="2" step="0.5">
            <input type="number" id="edgeMarginValue" class="value-input" value="2.0" min="0" max="20" step="0.5">
          </div>
        </div>

        <div class="slider-row" id="shapeSizeRow" style="display:none;">
          <label for="shapeSize">Shape Size (%)</label>
          <div class="slider-with-value">
            <input type="range" id="shapeSize" min="1" max="100" value="90" step="1">
            <input type="number" id="shapeSizeValue" class="value-input" value="90" min="1" max="100" step="1">
          </div>
        </div>

        <div class="slider-row" id="shapeFillModeRow" style="display:none;">
          <label for="shapeFillMode">Hole Distribution</label>
          <select id="shapeFillMode">
            <option value="outline">Outline only</option>
            <option value="filled">Filled</option>
          </select>
        </div>

        <div class="slider-row" id="holeSizeModeRow" style="display:none;">
          <label for="holeSizeMode">Hole Size Mode</label>
          <select id="holeSizeMode">
            <option value="uniform">Uniform</option>
            <option value="fibonacci" selected>Fibonacci Groups</option>
          </select>
        </div>

        <div class="slider-row" id="spacingRow">
          <label for="spacing">Spacing Factor (mm)</label>
          <div class="slider-with-value">
            <input type="range" id="spacing" min="0.1" max="15" value="2.2" step="0.1">
            <input type="number" id="spacingValue" class="value-input" value="2.2" min="0.1" max="15" step="0.1">
          </div>
        </div>

        <div class="slider-row" id="radialPowerRow">
          <label for="radialPower">Radial Power (n<sup>x</sup>)</label>
          <div class="slider-with-value">
            <input type="range" id="radialPower" min="0.1" max="1.5" value="0.5" step="0.01">
            <input type="number" id="radialPowerValue" class="value-input" value="0.50" min="0.1" max="1.5" step="0.01">
          </div>
          <span class=\"hint\">0.5 = uniform area per dot, &lt;0.5 sparse center, &gt;0.5 dense center</span>
        </div>

        <div class="slider-row" id="centerPackingRow">
          <label for="centerPacking">Center Packing</label>
          <div class="slider-with-value">
            <input type="range" id="centerPacking" min="0" max="3" value="0" step="0.1">
            <input type="number" id="centerPackingValue" class="value-input" value="0.0" min="0" max="3" step="0.1">
          </div>
          <span class="hint">0 = uniform, higher = denser center</span>
        </div>

        <div class="slider-row" id="dotSizeRow">
          <label for="dotSize">Dot Size (mm)</label>
          <div class="slider-with-value">
            <input type="range" id="dotSize" min="0.2" max="5" value="1.0" step="0.1">
            <input type="number" id="dotSizeValue" class="value-input" value="1.0" min="0.2" max="5" step="0.1">
          </div>
        </div>

        <div class="slider-row" id="dotSizeMinRow">
          <label for="dotSizeMin">Dot Min Size (mm)</label>
          <div class="slider-with-value">
            <input type="range" id="dotSizeMin" min="0" max="5" value="0.2" step="0.1">
            <input type="number" id="dotSizeMinValue" class="value-input" value="0.2" min="0" max="5" step="0.1">
          </div>
        </div>

        <div class="slider-row" id="dotOpacityRow">
          <label for="dotOpacity">Dot Opacity</label>
          <div class="slider-with-value">
            <input type="range" id="dotOpacity" min="0.05" max="1" value="1" step="0.05">
            <input type="number" id="dotOpacityValue" class="value-input" value="1.00" min="0.05" max="1" step="0.05">
          </div>
        </div>

        <div class="slider-row" id="goldenAngleRow">
          <label for="goldenAngle">Golden Angle (&deg;)</label>
          <div class="slider-with-value">
            <input type="range" id="goldenAngle" min="100" max="180" value="137.508" step="0.001">
            <input type="number" id="goldenAngleValue" class="value-input" value="137.508" min="100" max="180" step="0.001">
          </div>
          <button id="snapGoldenAngle" class="btn btn-small" title="Snap to true golden angle">&#x1F33B; 137.508&deg;</button>
        </div>

        <div class="slider-row" id="startAngleRow">
          <label for="startAngle">Start Angle Offset (&deg;)</label>
          <div class="slider-with-value">
            <input type="range" id="startAngle" min="0" max="360" value="0" step="1">
            <input type="number" id="startAngleValue" class="value-input" value="0" min="0" max="360" step="1">
          </div>
        </div>

        <button id="resetDefaults" class="btn btn-reset">Reset All Defaults</button>
      </section>

      <section class="control-group">
        <h2>Display Options</h2>
        <div class="checkbox-row">
          <input type="checkbox" id="showGrid" checked>
          <label for="showGrid">Show mm grid</label>
        </div>
        <div class="checkbox-row">
          <input type="checkbox" id="showMajorGrid" checked>
          <label for="showMajorGrid">Show 10mm grid</label>
        </div>
        <div class="checkbox-row">
          <input type="checkbox" id="showAxes" checked>
          <label for="showAxes">Show center axes</label>
        </div>
        <div class="checkbox-row">
          <input type="checkbox" id="showLabels" checked>
          <label for="showLabels">Show scale labels</label>
        </div>
      </section>

      <section class="control-group">
        <h2>Dot Style</h2>
        <div class="input-row">
          <label for="dotColor">Dot Color</label>
          <input type="color" id="dotColor" value="#d4a017">
        </div>
        <div class="checkbox-row">
          <input type="checkbox" id="fillDots" checked>
          <label for="fillDots">Fill dots</label>
        </div>
        <div class="input-row" id="dotColor2Row" style="display:none;">
          <label for="dotColor2">Spiral B Color</label>
          <input type="color" id="dotColor2" value="#4363d8">
        </div>
        <div class="slider-row" id="spiralBOffsetRow" style="display:none;">
          <label for="spiralBOffset">Spiral B Offset (&deg;)</label>
          <div class="slider-with-value">
            <input type="range" id="spiralBOffset" min="0" max="360" value="180" step="1">
            <input type="number" id="spiralBOffsetValue" class="value-input" value="180" min="0" max="360" step="1">
          </div>
        </div>
        <div class="slider-row" id="fibPairRow" style="display:none;">
          <label>Spiral families (CW / CCW)</label>
          <div class="spiral-presets">
            <button class="btn btn-tiny fib-pair" data-cw="8" data-ccw="13">8/13</button>
            <button class="btn btn-tiny fib-pair" data-cw="13" data-ccw="21">13/21</button>
            <button class="btn btn-tiny fib-pair active" data-cw="21" data-ccw="34">21/34</button>
            <button class="btn btn-tiny fib-pair" data-cw="34" data-ccw="55">34/55</button>
          </div>
          <span class="hint">Successive Fibonacci numbers</span>
        </div>
        <div class="checkbox-row" id="colorSpiralsRow">
          <input type="checkbox" id="colorSpirals">
          <label for="colorSpirals">Highlight spiral arms</label>
        </div>
        <div class="slider-row" id="spiralCountRow" style="display:none; margin-top:8px;">
          <label for="spiralCount">Spiral families</label>
          <div class="spiral-presets">
            <button class="btn btn-tiny spiral-preset" data-val="8">8</button>
            <button class="btn btn-tiny spiral-preset" data-val="13">13</button>
            <button class="btn btn-tiny spiral-preset active" data-val="21">21</button>
            <button class="btn btn-tiny spiral-preset" data-val="34">34</button>
            <button class="btn btn-tiny spiral-preset" data-val="55">55</button>
          </div>
        </div>
        <div class="slider-row" id="pineconeScaleRow" style="display:none;">
          <label for="pineconeScale">Pinecone Scale Gradient</label>
          <div class="slider-with-value">
            <input type="range" id="pineconeScale" min="0" max="1" value="0.7" step="0.05">
            <input type="number" id="pineconeScaleValue" class="value-input" value="0.70" min="0" max="1" step="0.05">
          </div>
          <span class="hint">0 = uniform, 1 = tiny center &rarr; full edge</span>
        </div>
        <div class="slider-row" id="sizeGradientRow">
          <label for="sizeGradient">Size Gradient</label>
          <select id="sizeGradient">
            <option value="none">None</option>
            <option value="inner-outer">Inner &rarr; Outer</option>
            <option value="outer-inner">Outer &rarr; Inner</option>
          </select>
        </div>
      </section>

      <section class="control-group">
        <h2>Presets</h2>
        <div class="preset-row">
          <input type="text" id="presetName" class="preset-name-input" placeholder="Preset name…">
          <button id="presetSave" class="btn btn-small-inline">Save</button>
        </div>
        <div class="preset-row" style="margin-top:6px;">
          <select id="presetList" class="preset-select">
            <option value="">— Select preset —</option>
          </select>
        </div>
        <div class="preset-row" style="margin-top:4px;">
          <button id="presetLoad" class="btn btn-small-inline">Load</button>
          <button id="presetDelete" class="btn btn-small-inline btn-danger">Delete</button>
        </div>
      </section>

      <section class="control-group">
        <h2>Export</h2>
        <div class="export-buttons">
          <button id="exportPNG" class="btn">Export PNG</button>
          <button id="exportSVG" class="btn">Export SVG</button>
          <button id="exportDXF" class="btn">Export DXF</button>
        </div>
      </section>

      <section class="control-group info">
        <h2>Info</h2>
        <p>Golden angle: <strong>137.508&deg;</strong></p>
        <p>Dot positions follow:<br>
          <code>r = spacing &times; n<sup>power</sup></code><br>
          <code>&theta; = n &times; golden_angle + offset</code>
        </p>
        <p id="infoStats" class="stats"></p>
      </section>
    </aside>

    <!-- Canvas Area -->
    <main class="canvas-area">
      <canvas id="sunflowerCanvas"></canvas>
    </main>
  </div>

  <script src="js/sunflower.js"></script>
</body>
</html>
